% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/get_log_FC.R
\name{get_log_fc}
\alias{get_log_fc}
\title{Compute Log2 Fold Change Between Two Groups}
\usage{
get_log_fc(dataset, x, grouping_variable, comparison = "a/b")
}
\arguments{
\item{dataset}{A data frame or tibble containing the data.
Must include the variable to be summarized and the grouping variable.}

\item{x}{A character referring to the numeric variable
for which the fold change should be calculated (e.g., \code{"Intensity")}).}

\item{grouping_variable}{grouping_variable. A character specifying the
grouping variable that defines the two comparison groups.
It must contain exactly two unique levels.}

\item{comparison}{A character string specifying the comparison direction.
Options are:
\itemize{
\item \code{"a/b"} (default): FC = mean(group A) / mean(group B)
\item \code{"b/a"}: FC = mean(group B) / mean(group A)
Any other value returns an error message.
}}
}
\value{
A data frame containing:
\itemize{
\item group means for each level of the grouping variable
\item fold change (FC)
\item log2 fold change (LogFC)
\item percent variation relative to the denominator group
}

If the grouping variable does not contain exactly two groups,
the function returns \code{NULL} and prints an informative message.
}
\description{
This function calculates fold change (FC), log2 fold change (log2FC),
and percent variation between two groups in a dataset.
The function expects exactly two groups in the specified grouping variable
and computes group means for a selected variable before calculating FC.
}
\examples{

\dontrun{
library(dplyr)
library(tidyr)

# Example: calculate log2 fold change per NMR bin

test_data <- test_dataset |>
  tidyr::gather(-atleta:-sample_year, key = "bin", value = "intensity") |>
  dplyr::group_by(bin)

# Compute log2 fold change between two groups defined in "LIP_adq"
test_data |>
  get_log_fc(
    x = "intensity",
    grouping_variable = "LIP_adq",
    comparison = "a/b"
  )
}

}
